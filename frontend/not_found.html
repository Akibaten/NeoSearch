<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- site font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">

    <title>NeoSearch</title>
    <!-- The style.css file allows you to change the look of your web pages.
          If you include the next line in all your web pages, they will all share the same look.
          This makes it easier to make new pages for your site. -->
    <link href="/css/results.css" rel="stylesheet" type="text/css" media="all">
    <script>
      function stopLoadingText() {
        clearInterval(loadingTextLoop) 
      }
    </script>
    <script src="/js/search.js"></script>
  </head>
  <body>
    <script>
      let mode = document.cookie;
      if(mode == "dark"){
        document.body.classList.toggle('dark-mode');
        console.log("true")
      }
    </script>
    <div id="header">
      <h1 id="title">
        <a href="/">NeoSearch</a>
      </h1>
      <div id="search-bar">
        <input type="text" id="search-bar-input" class="form-control" placeholder="Search Neocities!">
        <input type="submit" id="search-button" onclick="
            let query = document.getElementById('search-bar-input').value;
            window.location.href = `/search?q=${query}&page=1`" value="">
      </div>
      <!-- adds event for pressing enter in the search bar -->
      <div id="query-duration">
      </div>
    </div>
    <div id="results-page">
      <div id="results">
        <!-- loading screen -->
        <h1 id="loading" style="text-align: center"></h1>
        <script>
          var loading = document.getElementById("loading");
          loading.innerHTML = "Loading"
          loadingTextLoop = setInterval(function (){
            if(loading.innerHTML != "Loading..."){
              loading.innerHTML += "."
            }else{
              loading.innerHTML = "Loading"
            }
          },250)
        </script>
      </div>
      <div id="page-navigation">
      </div>
      <!-- adds event for pressing enter in the results page search bar -->
      <script>
        var input = document.getElementById("search-bar-input");
        input.addEventListener("keypress", function(event) {
          if (event.key === "Enter") {
            event.preventDefault();
            document.getElementById("search-button").click();
          }
          });
      </script>
    </div>
    <div id = "footer">
      <p>
        Found a bug or have suggestions or feedback? <strong><a href="https://forms.gle/BAt9t6RtBN4yNEhe9" style="color: blue">Fill out a form!</a></strong>
        I greatly appreciate it ˶ᵔᵕᵔ˶
      </p>
      <p>
        ⋆˚✿˖° Made with all the love in the world by <a href="https://akibaten.xyz" style="color: blue">sarah</a>°˖✿˚⋆
      </p>
    </div>
    <script>
      const params = new URLSearchParams(window.location.search);
      if(params.get("q") != null){
        getSearchData(params.get("q"), params.get("page")).then((searchResults) => renderResults(searchResults));
      }
      else{
        window.location.href="/";
      }
    </script>
  </body>
</html>
